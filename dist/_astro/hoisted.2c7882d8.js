const E=document.getElementById("theme-toggle");function w(){const e=localStorage.getItem("theme");e==="dark"||!e&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}w();E?.addEventListener("click",()=>{const e=document.documentElement.classList.toggle("dark");localStorage.setItem("theme",e?"dark":"light")});const y=document.getElementById("mobile-menu-toggle"),i=document.getElementById("mobile-sidebar-overlay"),p=document.getElementById("mobile-sidebar-panel"),I=document.getElementById("mobile-sidebar-close"),h=document.getElementById("mobile-sidebar-content");function B(){const e=document.querySelector("aside nav");e&&h&&(h.innerHTML=e.innerHTML),i?.classList.remove("hidden"),requestAnimationFrame(()=>{p?.classList.remove("-translate-x-full")}),document.body.style.overflow="hidden"}function m(){p?.classList.add("-translate-x-full"),setTimeout(()=>{i?.classList.add("hidden")},300),document.body.style.overflow=""}y?.addEventListener("click",B);I?.addEventListener("click",m);i?.addEventListener("click",e=>{e.target===i&&m()});document.addEventListener("keydown",e=>{e.key==="Escape"&&!i?.classList.contains("hidden")&&m()});const M=JSON.parse(document.getElementById("search-data")?.textContent||"[]"),s=document.getElementById("search-input"),d=document.getElementById("search-results");document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="k"&&(e.preventDefault(),s?.focus()),e.key==="Escape"&&document.activeElement===s&&(s?.blur(),u())});function u(){d?.classList.add("hidden")}function x(){d?.classList.remove("hidden")}function v(e){if(!e.trim()){u();return}const o=e.toLowerCase().split(/\s+/).filter(Boolean),c=M.map(t=>{let n=0,a="";const k=t.title.toLowerCase(),L=t.excerpt.toLowerCase(),g=t.headings.map(r=>r.toLowerCase());for(const r of o){k.includes(r)&&(n+=10);for(const f of g)f.includes(r)&&(n+=5,a||(a=t.headings[g.indexOf(f)]));L.includes(r)&&(n+=2)}return{...t,score:n,matchedHeading:a}}).filter(t=>t.score>0).sort((t,n)=>n.score-t.score).slice(0,8);if(c.length===0){d&&(d.innerHTML='<div class="p-4 text-sm text-docs-text-muted dark:text-docs-text-muted-dark text-center">No results found</div>'),x();return}d&&(d.innerHTML=c.map(t=>`
        <a href="${t.route}" class="block px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors border-b border-docs-border/50 dark:border-docs-border-dark/50 last:border-b-0">
          <div class="text-sm font-medium text-docs-text dark:text-docs-text-dark">${l(t.title,o)}</div>
          ${t.matchedHeading?`<div class="text-xs text-docs-accent dark:text-indigo-400 mt-0.5"># ${l(t.matchedHeading,o)}</div>`:""}
          ${t.excerpt?`<div class="text-xs text-docs-text-muted dark:text-docs-text-muted-dark mt-1 line-clamp-1">${l(t.excerpt.slice(0,100),o)}</div>`:""}
        </a>
      `).join("")),x()}function l(e,o){let c=T(e);for(const t of o){const n=new RegExp(`(${$(t)})`,"gi");c=c.replace(n,'<mark class="bg-yellow-200 dark:bg-yellow-800 text-inherit rounded px-0.5">$1</mark>')}return c}function T(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function $(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}let b;s?.addEventListener("input",()=>{clearTimeout(b),b=setTimeout(()=>{v(s.value)},150)});s?.addEventListener("focus",()=>{s.value.trim()&&v(s.value)});document.addEventListener("click",e=>{const o=document.getElementById("search-container");o&&!o.contains(e.target)&&u()});
